<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO-CRIC | AI Match Analytics</title>
    <!-- Dependencies -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Syncopate:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --brand-primary: #6366f1;
            --brand-accent: #22d3ee;
            --bg-dark: #020617;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-dark);
            color: #f8fafc;
            overflow-x: hidden;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .hero-text {
            font-family: 'Syncopate', sans-serif;
            text-transform: uppercase;
            letter-spacing: -2px;
            background: linear-gradient(135deg, #fff 0%, var(--brand-accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .team-input-group:focus-within .flag-container {
            border-color: var(--brand-accent);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);
        }

        /* Enhanced Styled Selects */
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='white' stroke-width='2'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            background-size: 1.25rem;
            cursor: pointer;
        }

        select option {
            background-color: #0f172a;
            color: #f8fafc;
        }

        .btn-predict {
            background: linear-gradient(135deg, var(--brand-primary) 0%, #4f46e5 100%);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-predict:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(99, 102, 241, 0.5);
        }

        .btn-predict:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .vs-divider::before, .vs-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }

        .loader-dots span {
            animation: bounce 0.6s infinite alternate;
        }
        .loader-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loader-dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce {
            to { transform: translateY(-6px); opacity: 0.5; }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Ambient Background Elements -->
    <div class="fixed top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-900/20 blur-[120px] rounded-full z-0"></div>
    <div class="fixed bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-cyan-900/20 blur-[120px] rounded-full z-0"></div>

    <main class="relative z-10 w-full max-w-4xl">
        <!-- Header -->
        <header class="text-center mb-10 opacity-0" id="header">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 text-xs font-semibold uppercase tracking-widest mb-4">
                <i data-lucide="cpu" class="w-3 h-3"></i> AI-Powered Prediction
            </div>
            <h1 class="hero-text text-4xl md:text-6xl mb-2">PRO-CRIC <span class="text-white">v2.0</span></h1>
            <p class="text-slate-400 font-light">Predicting victory through 10,000+ match simulations</p>
        </header>

        <!-- Main Interface -->
        <div class="glass-panel rounded-3xl overflow-hidden opacity-0" id="mainCard">
            <form id="predictForm" class="p-8 md:p-12">
                
                <!-- Versus Section -->
                <div class="grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-8 items-center mb-12">
                    
                    <!-- Team 1 -->
                    <div class="team-input-group text-center">
                        <div class="flag-container w-24 h-24 md:w-32 md:h-32 mx-auto rounded-full border-2 border-slate-700 p-1 mb-4 transition-all duration-500 bg-slate-900 overflow-hidden">
                            <img id="flag1" src="https://flagcdn.com/in.svg" class="w-full h-full object-cover rounded-full grayscale-[0.2]" alt="Team 1">
                        </div>
                        <label class="block text-xs text-slate-500 uppercase tracking-widest mb-2 font-bold">Primary Team</label>
                        <select name="team1" id="team1" class="w-full bg-slate-800/80 border border-slate-700 rounded-xl px-4 py-3 outline-none focus:border-indigo-500 transition-all text-lg hover:border-slate-500 shadow-lg" required>
                            <!-- Options populated by JS -->
                        </select>
                    </div>

                    <!-- VS -->
                    <div class="flex flex-col items-center justify-center">
                        <div class="vs-divider flex items-center w-full md:w-24 gap-4 mb-4">
                            <span class="text-2xl font-black italic text-slate-600">VS</span>
                        </div>
                        <div class="bg-slate-800 p-2 rounded-full border border-slate-700">
                            <i data-lucide="zap" class="w-5 h-5 text-yellow-400"></i>
                        </div>
                    </div>

                    <!-- Team 2 -->
                    <div class="team-input-group text-center">
                        <div class="flag-container w-24 h-24 md:w-32 md:h-32 mx-auto rounded-full border-2 border-slate-700 p-1 mb-4 transition-all duration-500 bg-slate-900 overflow-hidden">
                            <img id="flag2" src="https://flagcdn.com/au.svg" class="w-full h-full object-cover rounded-full grayscale-[0.2]" alt="Team 2">
                        </div>
                        <label class="block text-xs text-slate-500 uppercase tracking-widest mb-2 font-bold">Opponent Team</label>
                        <select name="team2" id="team2" class="w-full bg-slate-800/80 border border-slate-700 rounded-xl px-4 py-3 outline-none focus:border-indigo-500 transition-all text-lg hover:border-slate-500 shadow-lg" required>
                            <!-- Options populated by JS -->
                        </select>
                    </div>
                </div>

                <!-- Match Details -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-slate-400"><i data-lucide="map-pin" class="w-4 h-4"></i> Battleground</label>
                        <select name="venue" id="venue" class="w-full bg-slate-800/80 border border-slate-700 rounded-xl px-4 py-3 outline-none focus:border-cyan-500 transition-all shadow-md hover:border-slate-500" required>
                            <option value="">Select Venue</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-slate-400"><i data-lucide="coins" class="w-4 h-4"></i> Toss Victor</label>
                        <select name="toss_winner" id="toss_winner" class="w-full bg-slate-800/80 border border-slate-700 rounded-xl px-4 py-3 outline-none focus:border-cyan-500 transition-all shadow-md hover:border-slate-500" required>
                            <option value="">Select Winning Team</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2 text-sm text-slate-400"><i data-lucide="activity" class="w-4 h-4"></i> Strategy</label>
                        <select name="toss_decision" class="w-full bg-slate-800/80 border border-slate-700 rounded-xl px-4 py-3 outline-none focus:border-cyan-500 transition-all shadow-md hover:border-slate-500" required>
                            <option value="bat">Choose to Bat</option>
                            <option value="field">Choose to Field</option>
                        </select>
                    </div>
                </div>

                <!-- Action -->
                <button type="submit" id="predictBtn" class="btn-predict w-full py-5 rounded-2xl text-white font-bold text-lg uppercase tracking-widest flex items-center justify-center gap-3">
                    <i data-lucide="play-circle" class="w-6 h-6"></i>
                    Initiate Analytics Engine
                </button>

                <!-- Result Area -->
                <div id="resultContainer" class="mt-8 hidden">
                    <div id="loader" class="flex flex-col items-center gap-4 py-8">
                        <div class="loader-dots flex gap-1">
                            <span class="w-3 h-3 bg-cyan-400 rounded-full"></span>
                            <span class="w-3 h-3 bg-cyan-400 rounded-full"></span>
                            <span class="w-3 h-3 bg-cyan-400 rounded-full"></span>
                        </div>
                        <p class="text-cyan-400 text-sm font-mono tracking-tighter uppercase">Processing Data Arrays...</p>
                    </div>
                    <div id="predictionOutput" class="hidden">
                        <div class="bg-indigo-500/10 border border-indigo-500/20 rounded-2xl p-6 text-center">
                            <p class="text-slate-400 text-sm uppercase tracking-widest mb-2 font-semibold">Predicted Dominant Side</p>
                            <h2 id="winnerName" class="text-4xl md:text-5xl font-black text-white drop-shadow-[0_0_15px_rgba(99,102,241,0.5)]"></h2>
                            <div class="mt-4 flex justify-center items-center gap-2 text-indigo-400 font-mono text-sm">
                                <span class="animate-pulse">●</span> HIGH CONFIDENCE RATING
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Footer -->
        <footer class="mt-8 text-center text-slate-600 text-xs font-medium uppercase tracking-[0.2em]">
            Neural Engine v4.2.1 • &copy; 2024 CRIC-AI Global
        </footer>
    </main>

    <script>
        const teamsData = {
            "India": "in",
            "Australia": "au",
            "England": "gb-eng",
            "Pakistan": "pk",
            "New Zealand": "nz",
            "South Africa": "za",
            "West Indies": "um",
            "Sri Lanka": "lk"
        };

        const venues = [
            "Wankhede Stadium, Mumbai",
            "Eden Gardens, Kolkata",
            "Melbourne Cricket Ground",
            "The Lord's, London",
            "The Oval, London",
            "M.Chinnaswamy Stadium",
            "Brisbane Cricket Ground",
            "Basin Reserve, Wellington"
        ];

        // Initialize Lucide Icons
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }

        $(document).ready(function() {
            // Initial Population
            populateTeams();
            
            const venueSelect = $('#venue');
            venues.forEach(venue => {
                venueSelect.append(`<option value="${venue}">${venue}</option>`);
            });

            // Entry Animations
            gsap.to("#header", { opacity: 1, y: 0, duration: 1, ease: "power4.out" });
            gsap.to("#mainCard", { opacity: 1, y: 0, duration: 1, delay: 0.3, ease: "power4.out" });

            function populateTeams() {
                const t1 = $('#team1');
                const t2 = $('#team2');
                
                t1.empty();
                t2.empty();
                
                Object.keys(teamsData).forEach(team => {
                    t1.append(`<option value="${team}">${team}</option>`);
                    t2.append(`<option value="${team}">${team}</option>`);
                });
                
                // Set defaults and sync UI
                t2.val(Object.keys(teamsData)[1]);
                updateFlags();
                updateTossOptions();
            }

            function updateFlags() {
                const val1 = $('#team1').val();
                const val2 = $('#team2').val();
                $('#flag1').attr('src', `https://flagcdn.com/${teamsData[val1]}.svg`);
                $('#flag2').attr('src', `https://flagcdn.com/${teamsData[val2]}.svg`);
            }

            function updateTossOptions() {
                const tossSelect = $('#toss_winner');
                const val1 = $('#team1').val();
                const val2 = $('#team2').val();
                const currentToss = tossSelect.val();

                tossSelect.empty().append('<option value="">Select Winning Team</option>');
                tossSelect.append(`<option value="${val1}">${val1}</option>`);
                tossSelect.append(`<option value="${val2}">${val2}</option>`);
                
                // Keep selection if it's still valid
                if (currentToss === val1 || currentToss === val2) {
                    tossSelect.val(currentToss);
                }
            }

            // Mutual Exclusion Logic
            $('#team1, #team2').on('change', function() {
                const changedId = $(this).attr('id');
                const otherId = changedId === 'team1' ? '#team2' : '#team1';
                const currentVal = $(this).val();
                const otherVal = $(otherId).val();

                // If they are the same, switch the other one to something else
                if (currentVal === otherVal) {
                    const availableTeams = Object.keys(teamsData).filter(t => t !== currentVal);
                    $(otherId).val(availableTeams[0]);
                }

                // Update Visuals
                const flagId = changedId === 'team1' ? '#flag1' : '#flag2';
                const otherFlagId = changedId === 'team1' ? '#flag2' : '#flag1';

                gsap.to([flagId, otherFlagId], { 
                    rotationY: 90, 
                    duration: 0.2, 
                    onComplete: () => {
                        updateFlags();
                        gsap.to([flagId, otherFlagId], { rotationY: 0, duration: 0.2 });
                    }
                });

                updateTossOptions();
            });

            $('#predictForm').on('submit', async function(e) {
                e.preventDefault();
                const container = $('#resultContainer');
                const loader = $('#loader');
                const output = $('#predictionOutput');

                container.removeClass('hidden');
                output.addClass('hidden');
                loader.removeClass('hidden');

                $('html, body').animate({
                    scrollTop: container.offset().top - 50
                }, 500);

                const formData = new FormData(this);
                const jsonData = Object.fromEntries(formData.entries());

                try {
                    await new Promise(r => setTimeout(r, 2000));

                    const response = await fetch("https://match-predictor-3iio.onrender.com//predict", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(jsonData)
                    });

                    const result = await response.json();

                    loader.addClass('hidden');
                    output.removeClass('hidden');
                    
                    if (response.ok) {
                        $('#winnerName').text(result.predicted_winner).css('color', '#fff');
                        gsap.from("#predictionOutput", { scale: 0.9, opacity: 0, duration: 0.5, ease: "back.out" });
                    } else {
                        $('#winnerName').text("Analysis Failed").css('color', '#ef4444');
                    }

                } catch (err) {
                    loader.addClass('hidden');
                    output.removeClass('hidden');
                    $('#winnerName').text("Engine Offline").css('color', '#ef4444');
                    console.error(err);
                }
            });
        });
    </script>
</body>
</html>
